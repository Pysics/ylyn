<!--pages/chat/chat.wxml-->
<view class="container">
  <scroll-view class="chatBody" scroll-top="{{toTop}}" scroll-y="true" style="height: {{chatBodyHeight}}px">
    <block wx:for="{{messages}}" wx:key="message_id">
      <view class="me messageBlock" wx:if="{{item.user_id === userInfo.user_id}}">
        <image src="{{userInfo.avatar}}" class="avatar"></image>
        <view class="message">
          <view wx:if="{{item.type === 'mult'}}" class="multMsg">
            <block wx:for="{{item.content}}" wx:key="type">
              <text wx:if="{{item.type ==='text'}}">{{item.content}}</text>
              <image wx:if="{{item.type === 'face'}}" src="/images/faces/{{item.src}}" class="faceImg"></image>
            </block>
          </view>
          <image wx:if="{{item.type === 'img'}}" src="{{item.content}}" bindtap="prevImg" data-src='{{item.content}}' class="imgMsg"></image>
          <view class="angle"></view>
        </view>
      </view>
      <view class="friend messageBlock" wx:if="{{item.user_id !== userInfo.user_id}}">
        <image src="{{friendInfo.avatar}}" class="avatar"></image>
        <view class="message">
          <view wx:if="{{item.type === 'mult'}}" class="multMsg">
            <block wx:for="{{item.content}}" wx:key="type">
              <text wx:if="{{item.type ==='text'}}">{{item.content}}</text>
              <image wx:if="{{item.type === 'face'}}" src="/images/faces/{{item.src}}" class="faceImg"></image>
            </block>
          </view>
          <image wx:if="{{item.type === 'img'}}" src="{{item.content}}" bindtap="prevImg" data-src='{{item.content}}' class="imgMsg"></image>
          <view class="angle"></view>
        </view>
      </view>
    </block>
  </scroll-view>
  <view class="chatBar" animation="{{chatBarChangeHeightAnimation}}">
    <view class="faceContent">

      <import src="/pages/common/face/face" />
      <template is="face" data="{{faces}}" />

    </view>
    <view class="faceDivision" animation="{{divisionSlideToRightAnimation}}"></view>
    <view class="chatBarContent">
      <view class="userCard"><text class="fa fa-vcard-o"></text></view>
      <view class="inputWrap">
        <input class="input" bindfocus="inputFocus" bindblur="inputBlur" value="{{inputValue}}" bindinput="inputHandle" />
      </view>
      <view class="face" bindtap="toggleFace"><text class="fa fa-meh-o"></text></view>
      <view class="pic">
        <view class="fa fa-picture-o" wx:if="{{!isFocus}}" bindtap="sendPic"></view>
        <view class="submit" wx:if="{{isFocus}}" bindtap="submit">发送</view>
      </view>
    </view>
    
  </view>
</view>
